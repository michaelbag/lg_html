# Changelog v2.16 (2025-01-17)

## Новые возможности

### Улучшенная поддержка CSV файлов из Excel
- **Автоматическое определение формата CSV**: Поддержка табуляции, точки с запятой и запятой
- **Обработка экранированных кавычек**: Автоматическая обработка `""` → `"`
- **Обработка строк с точкой с запятой в конце**: Корректная обработка Excel-формата с `;` в конце строки
- **Фильтрация чисел в научной нотации**: Автоматический пропуск строк с числами типа `1,0452E+17`
- **Обработка пустых строк**: Игнорирование пустых строк в CSV

### Технические улучшения
- Добавлена функция `clean_csv_field()` для очистки полей от экранированных кавычек
- Добавлена функция `detect_csv_format()` для автоматического определения формата файла
- Улучшена функция `read_csv_data()` с поддержкой всех Excel-форматов
- Обновлена документация с примерами поддерживаемых форматов

## Исправления
- Исправлена обработка CSV файлов, экспортированных из Excel
- Улучшена стабильность парсинга при различных форматах разделителей
- Исправлена обработка строк с кавычками и специальными символами

## Документация
- Обновлен `README.md` с описанием поддерживаемых CSV форматов
- Обновлен `GEN2_USAGE.md` с примерами Excel-форматов
- Добавлены примеры обработки экранированных кавычек и научной нотации

## Совместимость
- Полная обратная совместимость с существующими CSV файлами
- Поддержка всех ранее поддерживаемых форматов
- Автоматическое определение формата без необходимости изменения команд

## Тестирование
- Протестирована обработка файла `c_test.csv` с проблемными Excel-форматами
- Успешная генерация PDF с 5 корректными записями из 7 строк
- Время обработки: 0.3 секунды

## Новые возможности

### Параметр --max-rows для тестирования
- **Новый параметр `--max-rows N`**: Ограничение количества обрабатываемых строк
- **Быстрое тестирование**: Обработка только первых N строк из CSV файла
- **Информативные сообщения**: Уведомление о тестовом режиме и достижении лимита
- **Пример использования**: `python gen2.py data.csv maket.pdf test.pdf -t single -dx 10 -dy 5 -ds 15 --max-rows 10`
