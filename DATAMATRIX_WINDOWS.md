# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ DataMatrix –Ω–∞ Windows 10/11

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã

`pylibdmtx` - —ç—Ç–æ Python –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `libdmtx`, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ù–∞ Windows —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.

## –ú–µ—Ç–æ–¥—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### ü•á –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ Anaconda/Miniconda (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç Visual Studio Build Tools
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```cmd
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Anaconda –∏–ª–∏ Miniconda
# –°–∫–∞—á–∞–π—Ç–µ —Å https://anaconda.com/download

# 2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
conda create -n labelgen python=3.9
conda activate labelgen

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
conda install -c conda-forge pillow reportlab pypdf2 qrcode
conda install -c conda-forge pylibdmtx

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
python -c "from pylibdmtx import pylibdmtx; print('DataMatrix —Ä–∞–±–æ—Ç–∞–µ—Ç!')"
```

### ü•à –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ pip + Visual Studio Build Tools

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Visual Studio Build Tools 2019 –∏–ª–∏ –Ω–æ–≤–µ–µ
- Windows SDK

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```cmd
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Visual Studio Build Tools
# –°–∫–∞—á–∞–π—Ç–µ —Å https://visualstudio.microsoft.com/downloads/
# –í—ã–±–µ—Ä–∏—Ç–µ "C++ build tools"

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade pip setuptools wheel
pip install pylibdmtx

# 3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
pip install --only-binary=all pylibdmtx
```

### ü•â –ú–µ—Ç–æ–¥ 3: –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ wheel —Ñ–∞–π–ª—ã

**–î–ª—è Python 3.8-3.11:**
```cmd
# –°–∫–∞—á–∞–π—Ç–µ wheel —Ñ–∞–π–ª —Å https://www.lfd.uci.edu/~gohlke/pythonlibs/#pylibdmtx
# –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –≤–µ—Ä—Å–∏—é –¥–ª—è –≤–∞—à–µ–≥–æ Python

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ wheel
pip install pylibdmtx-0.1.9-cp39-cp39-win_amd64.whl
```

### üîÑ –ú–µ—Ç–æ–¥ 4: Fallback –Ω–∞ QR –∫–æ–¥—ã

**–ï—Å–ª–∏ DataMatrix –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```cmd
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–ª—å–∫–æ QR –∫–æ–¥—ã
pip install -r requirements-minimal.txt

# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ QR –∫–æ–¥—ã
```

## –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ Python
```cmd
python --version
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å Python 3.8 –∏–ª–∏ –Ω–æ–≤–µ–µ
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ pip
```cmd
pip --version
pip install --upgrade pip
```

### –®–∞–≥ 3: –¢–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ pylibdmtx
```cmd
python -c "
try:
    from pylibdmtx import pylibdmtx
    print('‚úÖ pylibdmtx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ')
    
    # –¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    encoded = pylibdmtx.encode(b'test')
    print('‚úÖ DataMatrix –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç')
except ImportError as e:
    print(f'‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: {e}')
except Exception as e:
    print(f'‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {e}')
"
```

### –®–∞–≥ 4: –¢–µ—Å—Ç –≤ —Å–∫—Ä–∏–ø—Ç–µ
```cmd
python main.py --version
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pylibdmtx –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DataMatrix –∫–æ–¥–æ–≤"
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Microsoft Visual C++ 14.0 is required"

**–†–µ—à–µ–Ω–∏–µ:**
```cmd
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Visual Studio Build Tools
# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ conda:
conda install -c conda-forge pylibdmtx
```

### –û—à–∏–±–∫–∞: "libdmtx not found"

**–†–µ—à–µ–Ω–∏–µ:**
```cmd
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —á–µ—Ä–µ–∑ conda
conda install -c conda-forge libdmtx

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ wheel
pip install pylibdmtx --only-binary=all
```

### –û—à–∏–±–∫–∞: "No module named 'pylibdmtx'"

**–†–µ—à–µ–Ω–∏–µ:**
```cmd
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
conda activate labelgen  # –∏–ª–∏ –≤–∞—à–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
pip uninstall pylibdmtx
pip install pylibdmtx
```

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```cmd
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
conda install -c conda-forge gcc_win-64 gxx_win-64

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ conda –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
conda install -c conda-forge pylibdmtx
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker
```dockerfile
# Dockerfile
FROM python:3.9-slim

RUN apt-get update && apt-get install -y \
    libdmtx0a libdmtx-dev \
    && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
CMD ["python", "main.py"]
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WSL2
```bash
# –í WSL2 (Ubuntu)
sudo apt-get update
sudo apt-get install libdmtx0a libdmtx-dev
pip install pylibdmtx
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

**qrcode (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç):**
```python
import qrcode
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –≤ —Å–∫—Ä–∏–ø—Ç–µ
```

**python-barcode:**
```cmd
pip install python-barcode[images]
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞
```cmd
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π CSV
echo 01046000000000121=ABC1234567890,–ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è,–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç > test.csv

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
python main.py test.csv output_test

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
dir output_test
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ DataMatrix:
```
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —ç—Ç–∏–∫–µ—Ç–æ–∫ —Å DataMatrix/QR –∫–æ–¥–∞–º–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ v1.0.0
–ê–≤—Ç–æ—Ä: Michael Bag
--------------------------------------------------
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pylibdmtx –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DataMatrix –∫–æ–¥–æ–≤
EAC –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: eac.png
–ü—Ä–æ—á–∏—Ç–∞–Ω–æ 1 —Å—Ç—Ä–æ–∫ –∏–∑ CSV —Ñ–∞–π–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º '	'
–°–æ–∑–¥–∞–Ω–∞ —ç—Ç–∏–∫–µ—Ç–∫–∞ 1: label_001.jpg (–º–∞—Å—à—Ç–∞–± DataMatrix: 1.0)
HTML —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω: output_test/labels.html
PDF —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω: output_test/labels.pdf
–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ —ç—Ç–∏–∫–µ—Ç–æ–∫: 1
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø—Ä–∏ fallback –Ω–∞ QR:
```
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —ç—Ç–∏–∫–µ—Ç–æ–∫ —Å DataMatrix/QR –∫–æ–¥–∞–º–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ v1.0.0
–ê–≤—Ç–æ—Ä: Michael Bag
--------------------------------------------------
–í–Ω–∏–º–∞–Ω–∏–µ: pylibdmtx –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è QR –∫–æ–¥ –≤–º–µ—Å—Ç–æ DataMatrix
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Anaconda/Miniconda
2. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker –∏–ª–∏ –ø—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ wheel
3. **–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ QR –∫–æ–¥—ã (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç)
4. **–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:** –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

DataMatrix –Ω–∞ Windows —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –Ω–æ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å conda –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏–ª–∏ –∏–º–µ—Ç—å fallback –Ω–∞ QR –∫–æ–¥—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
